<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>마이페이지 | #일상</title>
	<link rel="stylesheet" href="/css/common/normalize.css">
	<link rel="stylesheet" href="/css/common/default.css">
	<link rel="stylesheet" href="/css/common/header.css">
	<link rel="stylesheet" href="/css/user/user.css">
	<link rel='stylesheet' href='https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css'>
</head>
<body>
	<%- include("../common/header.ejs") %> 
	<main>
		<div id="myinfo">
			<h1>마이페이지</h1>
			<section class="profileSection">
				<h3><%= user.name %>
					<small><%= user.id %> </small>
				</h3>
				<form action="/user/myinfo" method="post" enctype="multipart/form-data">
					<label for="profile" style="cursor: pointer;">
						<img src="<%=user.image ?? '/images/user/userProfile.png' %>" alt="user profile image" class="userProfileImg">
						<span class="newFileName"></span>
						<input type="file" name="profile" id="profile" accept="image/*" onchange="preview(event)">
					</label>
					<button class="btn updateBtn">변경하기</button>
				</form>
			</section>
		</div>
	</main>
	<script>
		logout();
		function preview(evt) {
			if(evt.target.files && evt.target.files[0]) {
				// image preview
				console.log(evt.target.files[0]);
				let reader = new FileReader();	// browser host 객체
				reader.readAsDataURL(evt.target.files[0]);
				reader.onload = function(rst) {
					console.log(rst.target.result);
					document.querySelector('.userProfileImg').src = rst.target.result;
				}
				// update button
				let updateBtn = document.querySelector('.updateBtn');
				updateBtn.style.display = 'block'
			}
		}
		
		function logout() {
			let userInfoLink = document.querySelector('.headerRight');
			let html = `
				<a href="/user/exit" class="logoutLink"><button type="button"><i class="fi fi-rr-sign-out-alt"></i> Logout</button></a>
			`
			userInfoLink.innerHTML = html;
		}
	</script>
</body>
</html